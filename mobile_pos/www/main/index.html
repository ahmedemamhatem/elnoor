<!DOCTYPE html>

<html lang="ar" dir="rtl">

<head>

<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<title>Elnoor-Ø§Ù„Ù†ÙˆØ± </title>
<link rel="icon" type="image/png" href="/assets/mobile_pos/icons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/mobile_pos/icons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/mobile_pos/icons/favicon-96x96.png">
<link rel="manifest" href="/main/manifest.json">


<meta name="theme-color" content="#2563eb">

<link rel="apple-touch-icon" href="/assets/mobile_pos/icons/apple-touch-icon.png">

<meta name="color-scheme" content="light">

<style>

:root{

--bg:#f0f4f8;

--bg-top:#e0f2fe;

--card:#ffffff;

--muted:#64748b;

--text:#0f172a;

--primary:#0ea5e9;

--primary-2:#38bdf8;

--accent:#6366f1;

--success:#16a34a;

--danger:#ef4444;

--border:#e2e8f0;

--shadow-sm:0 8px 20px rgba(14, 165, 233, .08);

--shadow:0 20px 50px rgba(14, 165, 233, .12);

--shadow-lg:0 30px 70px rgba(14, 165, 233, .15);

--radius-xl:24px;

--radius-lg:20px;

--radius-md:16px;

--radius-sm:12px;

--glass-bg:rgba(255, 255, 255, 0.75);

--glass-border:rgba(255, 255, 255, 0.4);

}

*{box-sizing:border-box}

html,body{height:100%}

body{

margin:0;

font-family:"Cairo","Tajawal",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Kufi Arabic",sans-serif;

color:var(--text);

background:
radial-gradient(ellipse 1400px 700px at 50% -300px, rgba(56, 189, 248, 0.18) 0%, transparent 55%),
radial-gradient(ellipse 900px 450px at 20% 100%, rgba(99, 102, 241, 0.1) 0%, transparent 45%),
radial-gradient(ellipse 700px 350px at 80% 100%, rgba(14, 165, 233, 0.08) 0%, transparent 45%),
linear-gradient(180deg, #e8f4f8 0%, #f0f9ff 50%, #e0f2fe 100%);

background-attachment:fixed;

min-height:100vh;

}

.container{max-width:980px;margin:32px auto;padding:0 20px}

/* Topbar */

.topbar{

display:flex;align-items:center;justify-content:space-between;margin:0 0 24px;

background:rgba(255, 255, 255, 0.85);
backdrop-filter:blur(25px) saturate(200%);

-webkit-backdrop-filter:blur(25px) saturate(200%);

border:1px solid rgba(255,255,255,0.6);
border-radius:var(--radius-lg);

padding:18px 24px;
box-shadow:0 10px 40px rgba(14, 165, 233, .1), 0 2px 8px rgba(0,0,0,.04);

animation:slideDown 0.5s ease-out;

position:relative;

}

.topbar-actions{

display:flex;

gap:10px;

align-items:center;

}

@keyframes slideDown{

from{opacity:0;transform:translateY(-20px)}

to{opacity:1;transform:translateY(0)}

}

.brand{

display:flex;align-items:center;gap:14px;font-weight:900;font-size:1.3rem;

letter-spacing:-0.03em;

background:linear-gradient(135deg, #0f172a 0%, #334155 100%);

-webkit-background-clip:text;background-clip:text;

-webkit-text-fill-color:transparent;

transition:all 0.4s ease;

position:relative;

padding:8px 16px;

border-radius:var(--radius-lg);

}

.brand::before{

content:'';

position:absolute;

inset:0;

background:linear-gradient(135deg, rgba(14,165,233,0.1), rgba(99,102,241,0.08));

border-radius:var(--radius-lg);

opacity:0;

transition:opacity 0.3s ease;

z-index:-1;

}

.brand:hover{

transform:scale(1.05);

}

.brand:hover::before{

opacity:1;

}

.brand-logo{

transition:transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1), filter 0.3s ease;

position:relative;

z-index:1;

}

.brand:hover .brand-logo{

transform:rotate(8deg) scale(1.12);

filter:brightness(1.15) drop-shadow(0 6px 20px rgba(14, 165, 233, 0.4));

}

.top-actions{display:flex;gap:10px;align-items:center;flex-wrap:wrap}

.btn{

appearance:none;border:1px solid transparent;background:transparent;color:var(--text);

padding:11px 18px;border-radius:var(--radius-md);cursor:pointer;font-weight:700;

line-height:1.2;font-size:0.95rem;

transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);

position:relative;overflow:hidden;

}

.btn::before{

content:'';position:absolute;inset:0;

background:linear-gradient(135deg, rgba(255,255,255,0.3), transparent);

opacity:0;transition:opacity 0.3s ease;

}

.btn:hover::before{opacity:1}

.btn:hover{transform:translateY(-2px);box-shadow:var(--shadow)}

.btn:active{transform:translateY(0) scale(0.98)}

.btn-primary{

color:#fff;background:linear-gradient(135deg,#0ea5e9 0%,#38bdf8 100%);

border-color:#0000;box-shadow:var(--shadow-sm);

}

.btn-primary:hover{

background:linear-gradient(135deg,#0284c7 0%,#0ea5e9 100%);

box-shadow:0 12px 30px rgba(14, 165, 233, .25);

}

.btn-danger{

color:#fff;background:linear-gradient(135deg,#f43f5e 0%,#fb7185 100%);

border-color:#0000;box-shadow:var(--shadow-sm);

}

.btn-danger:hover{

background:linear-gradient(135deg,#e11d48 0%,#f43f5e 100%);

box-shadow:0 12px 30px rgba(244, 63, 94, .25);

}

.btn-success{

color:#fff;background:linear-gradient(135deg,#16a34a 0%,#22c55e 100%);

border-color:#0000;box-shadow:var(--shadow-sm);

}

.btn-success:hover{

background:linear-gradient(135deg,#15803d 0%,#16a34a 100%);

box-shadow:0 12px 30px rgba(22, 163, 74, .25);

}

.btn-ghost{

border-color:var(--border);background:rgba(255,255,255,0.9);

backdrop-filter:blur(10px);

}

.btn-ghost:hover{

background:rgba(255,255,255,1);

border-color:var(--primary);

}

.btn[disabled]{opacity:.5;cursor:not-allowed;transform:none !important}

/* Card */
.card{
  background:rgba(255, 255, 255, 0.88);
  backdrop-filter:blur(30px) saturate(200%);
  -webkit-backdrop-filter:blur(30px) saturate(200%);
  border:1px solid rgba(255,255,255,0.7);
  border-radius:var(--radius-xl);
  padding:32px 28px;
  box-shadow:0 25px 60px rgba(14, 165, 233, .12), 0 5px 15px rgba(0,0,0,.05);
  position:relative;overflow:hidden;
  animation:fadeInUp 0.6s ease-out;
}

.card::before{
  content:'';position:absolute;top:-50%;right:-50%;
  width:200%;height:200%;
  background:radial-gradient(circle at 30% 30%, rgba(56,189,248,0.12) 0%, transparent 60%);
  animation:rotate 25s linear infinite;pointer-events:none;
}

.card::after{
  content:'';position:absolute;bottom:-30%;left:-30%;
  width:150%;height:150%;
  background:radial-gradient(circle at 70% 70%, rgba(99,102,241,0.08) 0%, transparent 55%);
  animation:rotate 30s linear infinite reverse;pointer-events:none;
}

@keyframes rotate{
  from{transform:rotate(0deg)}
  to{transform:rotate(360deg)}
}

@keyframes fadeInUp{
  from{opacity:0;transform:translateY(30px)}
  to{opacity:1;transform:translateY(0)}
}

/* Hero */
.hero{
  background:linear-gradient(135deg,
    rgba(14,165,233,.12) 0%,
    rgba(56,189,248,.08) 50%,
    rgba(99,102,241,.06) 100%
  );
  border:2px solid rgba(56,189,248,0.2);
  border-radius:24px;
  padding:28px 24px 24px;
  display:flex;
  flex-direction:column;
  gap:20px;
  position:relative;
  overflow:hidden;
  box-shadow:inset 0 1px 2px rgba(255,255,255,0.5), 0 4px 16px rgba(14,165,233,0.06);
}

.hero-header{
  display:flex;
  align-items:flex-start;
  gap:16px;
  position:relative;
  z-index:1;
}

.hero-greeting-icon{
  font-size:3.5em;
  line-height:1;
  filter:drop-shadow(0 4px 12px rgba(14,165,233,0.3));
  animation:wave 2.5s ease-in-out infinite;
  transform-origin:70% 70%;
  flex-shrink:0;
}

.hero-content{
  flex:1;
  display:flex;
  flex-direction:column;
  gap:6px;
  text-align:right;
}

.hero::after{
  content:'';position:absolute;top:-20%;right:-10%;
  width:250px;height:250px;
  background:radial-gradient(circle, rgba(99,102,241,0.2) 0%, transparent 65%);
  border-radius:50%;filter:blur(50px);
  animation:pulse 5s ease-in-out infinite;
}

.hero::before{
  content:'';position:absolute;bottom:-20%;left:-10%;
  width:200px;height:200px;
  background:radial-gradient(circle, rgba(14,165,233,0.15) 0%, transparent 65%);
  border-radius:50%;filter:blur(45px);
  animation:pulse 6s ease-in-out infinite 1s;
}

@keyframes pulse{
  0%,100%{transform:scale(1);opacity:0.5}
  50%{transform:scale(1.1);opacity:0.8}
}

@keyframes wave{
  0%,100%{transform:rotate(0deg)}
  10%{transform:rotate(14deg)}
  20%{transform:rotate(-8deg)}
  30%{transform:rotate(14deg)}
  40%{transform:rotate(-4deg)}
  50%{transform:rotate(10deg)}
  60%{transform:rotate(0deg)}
}

.hero-title{
  margin:0;
  font-size:2rem;
  font-weight:800;
  letter-spacing:-0.02em;
  color:#0f172a;
  line-height:1.2;
  text-shadow:0 2px 6px rgba(0,0,0,0.08);
}

.hero-sub{
  margin:0;
  color:#475569;
  font-weight:600;
  font-size:1rem;
  line-height:1.5;
  text-shadow:0 1px 2px rgba(0,0,0,0.05);
}

/* User Info Grid */
.user-info-grid{
  display:grid;
  grid-template-columns:repeat(2, 1fr);
  gap:12px;
  position:relative;
  z-index:1;
}

.info-card{
  display:flex;
  align-items:center;
  gap:12px;
  background:rgba(255,255,255,0.95);
  backdrop-filter:blur(12px);
  -webkit-backdrop-filter:blur(12px);
  border:1.5px solid rgba(255,255,255,0.9);
  border-radius:16px;
  padding:14px 16px;
  box-shadow:0 4px 12px rgba(14,165,233,0.08), 0 1px 3px rgba(0,0,0,0.04);
  transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position:relative;
  overflow:hidden;
}

.info-card::before{
  content:'';
  position:absolute;
  inset:0;
  background:linear-gradient(135deg, rgba(56,189,248,0.1), rgba(99,102,241,0.08));
  opacity:0;
  transition:opacity 0.3s ease;
}

.info-card:hover{
  transform:translateY(-2px);
  box-shadow:0 8px 20px rgba(14,165,233,0.12), 0 2px 6px rgba(0,0,0,0.06);
  border-color:rgba(56,189,248,0.4);
}

.info-card:hover::before{
  opacity:1;
}

.info-icon{
  width:44px;
  height:44px;
  border-radius:12px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:1.2rem;
  flex-shrink:0;
  transition:all 0.3s ease;
  position:relative;
  z-index:1;
}

.user-icon{
  background:linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
  color:white;
  box-shadow:0 4px 12px rgba(14,165,233,0.3);
}

.warehouse-icon{
  background:linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
  color:white;
  box-shadow:0 4px 12px rgba(139,92,246,0.3);
}

.info-card:hover .info-icon{
  transform:scale(1.1) rotate(-5deg);
}

.info-details{
  display:flex;
  flex-direction:column;
  gap:4px;
  flex:1;
  min-width:0;
  text-align:right;
  position:relative;
  z-index:1;
}

.info-label{
  font-size:0.8rem;
  font-weight:600;
  color:#64748b;
  text-transform:uppercase;
  letter-spacing:0.02em;
}

.info-value{
  font-size:1rem;
  font-weight:800;
  color:#0f172a;
  letter-spacing:-0.01em;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

.info-value.skeleton{
  height:16px;
  width:100%;
  max-width:120px;
  display:block;
  border-radius:8px;
}

/* Actions */
.actions-grid{
  display:grid;
  grid-template-columns:1fr;
  gap:20px;
  margin-top:28px;
}

.action{
  display:flex;
  flex-direction:row;
  align-items:center;
  justify-content:space-between;
  text-align:right;
  gap:12px;
  min-height:85px;
  padding:16px 14px;
  border-radius:14px;
  text-decoration:none;
  color:#fff;
  font-weight:700;
  box-shadow:0 6px 18px rgba(0,0,0,0.1), 0 2px 6px rgba(0,0,0,0.06);
  transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position:relative;
  overflow:hidden;
}

.action-content{
  display:flex;
  align-items:center;
  gap:12px;
  flex:1;
  z-index:1;
}

.action-icon-wrapper{
  width:48px;
  height:48px;
  display:flex;
  align-items:center;
  justify-content:center;
  background:rgba(255,255,255,0.2);
  border-radius:12px;
  backdrop-filter:blur(10px);
  flex-shrink:0;
  transition:all 0.3s ease;
}

.action-image{
  width:32px;
  height:32px;
  border-radius:8px;
  object-fit:cover;
  transition:all 0.3s ease;
}

.action-text{
  display:flex;
  flex-direction:column;
  gap:3px;
  flex:1;
}

.action-title{
  margin:0;
  font-size:1.05rem;
  font-weight:800;
  letter-spacing:-0.02em;
  text-shadow:0 2px 8px rgba(0,0,0,0.2);
}

.action-desc{
  margin:0;
  font-size:0.8rem;
  font-weight:500;
  opacity:0.9;
  text-shadow:0 1px 4px rgba(0,0,0,0.15);
}

.action-arrow{
  width:28px;
  height:28px;
  display:flex;
  align-items:center;
  justify-content:center;
  background:rgba(255,255,255,0.2);
  border-radius:50%;
  flex-shrink:0;
  transition:all 0.3s ease;
  z-index:1;
}

.action-arrow i{
  font-size:0.85rem;
  transition:transform 0.3s ease;
}

.action::before{
  content:'';position:absolute;inset:0;
  background:linear-gradient(135deg, rgba(255,255,255,0.25) 0%, transparent 60%);
  opacity:0;transition:opacity 0.4s ease;
}

.action::after{
  content:'';
  position:absolute;
  top:50%;left:50%;
  width:0;height:0;
  border-radius:50%;
  background:rgba(255,255,255,0.3);
  transform:translate(-50%, -50%);
  transition:width 0.6s ease, height 0.6s ease;
}

.action:hover::before{opacity:1}

.action:hover::after{
  width:400px;
  height:400px;
}

.action:hover{
  transform:translateY(-4px);
  box-shadow:0 16px 40px rgba(0,0,0,0.18), 0 4px 12px rgba(0,0,0,0.12);
}

.action:hover .action-icon-wrapper{
  transform:scale(1.1) rotate(-5deg);
  background:rgba(255,255,255,0.3);
}

.action:hover .action-image{
  transform:scale(1.1);
}

.action:hover .action-arrow{
  background:rgba(255,255,255,0.3);
  transform:translateX(-4px);
}

.action:hover .action-arrow i{
  transform:translateX(-2px);
}

.action:active{
  transform:translateY(-2px);
  transition:all 0.1s ease;
}

.action:active .action-icon-wrapper{
  transform:scale(1.05);
}

.act-pos{
  background:linear-gradient(135deg,#3b82f6 0%,#2563eb 50%,#1d4ed8 100%);
  border:1px solid rgba(37,99,235,0.4);
}

.act-pos:hover{
  box-shadow:0 25px 60px rgba(37,99,235,0.4), 0 10px 25px rgba(37,99,235,0.25), 0 0 40px rgba(37,99,235,0.2);
}

.act-truck{
  background:linear-gradient(135deg,#10b981 0%,#059669 50%,#047857 100%);
  border:1px solid rgba(16,185,129,0.4);
}

.act-truck:hover{
  box-shadow:0 25px 60px rgba(16,185,129,0.4), 0 10px 25px rgba(16,185,129,0.25), 0 0 40px rgba(16,185,129,0.2);
}

.act-orders{
  background:linear-gradient(135deg,#f59e0b 0%,#f97316 50%,#ea580c 100%);
  border:1px solid rgba(245,158,11,0.4);
}

.act-orders:hover{
  box-shadow:0 25px 60px rgba(245,158,11,0.4), 0 10px 25px rgba(245,158,11,0.25), 0 0 40px rgba(245,158,11,0.2);
}

.act-admin{
  background:linear-gradient(135deg,#8b5cf6 0%,#7c3aed 50%,#6d28d9 100%);
  border:1px solid rgba(139,92,246,0.4);
}

.act-admin:hover{
  box-shadow:0 25px 60px rgba(139,92,246,0.4), 0 10px 25px rgba(139,92,246,0.25), 0 0 40px rgba(139,92,246,0.2);
}

.disabled .action{
  filter:grayscale(.85) opacity(.65);
  pointer-events:none;
  transform:none !important;
  box-shadow:0 4px 12px rgba(0,0,0,0.06);
}

.disabled .action::after{
  content:'ğŸ”’';
  position:absolute;
  top:20px;
  right:20px;
  font-size:1.5em;
  opacity:0.8;
  filter:grayscale(0);
  z-index:2;
}

.disabled .action-title,
.disabled .action-desc{
  opacity:0.7;
}

.disabled .action-icon-wrapper{
  background:rgba(255,255,255,0.15);
}

.disabled .action-arrow{
  background:rgba(255,255,255,0.15);
}

/* Info + error */
.notice{
  margin-top:16px;border-radius:var(--radius-md);padding:14px 18px;font-weight:700;
  border:2px solid rgba(249,115,22,0.3);
  background:linear-gradient(135deg,rgba(255,247,237,0.95) 0%,rgba(254,243,199,0.9) 100%);
  backdrop-filter:blur(10px);
  color:#9a3412;box-shadow:0 8px 20px rgba(249,115,22,0.1);
  animation:slideIn 0.4s ease-out;
  position:relative;overflow:hidden;
}

.notice::before{
  content:'âš ï¸';position:absolute;right:18px;top:50%;
  transform:translateY(-50%);font-size:1.3rem;
  animation:bounce 2s ease-in-out infinite;
}

@keyframes bounce{
  0%,100%{transform:translateY(-50%) scale(1)}
  50%{transform:translateY(-55%) scale(1.1)}
}

.error{
  margin-top:16px;border-radius:var(--radius-md);padding:14px 18px;font-weight:700;
  border:2px solid rgba(239,68,68,0.3);
  background:linear-gradient(135deg,rgba(254,226,226,0.95) 0%,rgba(252,165,165,0.9) 100%);
  backdrop-filter:blur(10px);
  color:#7f1d1d;box-shadow:0 8px 20px rgba(239,68,68,0.12);
  animation:shake 0.5s ease-out, slideIn 0.4s ease-out;
}

@keyframes shake{
  0%,100%{transform:translateX(0)}
  25%{transform:translateX(-8px)}
  75%{transform:translateX(8px)}
}

.success-msg{
  margin-top:16px;border-radius:var(--radius-md);padding:14px 18px;font-weight:700;
  border:2px solid rgba(34,197,94,0.3);
  background:linear-gradient(135deg,rgba(220,252,231,0.95) 0%,rgba(187,247,208,0.9) 100%);
  backdrop-filter:blur(10px);
  color:#14532d;box-shadow:0 8px 20px rgba(34,197,94,0.12);
  animation:slideIn 0.4s ease-out;
  position:relative;overflow:hidden;
}

.success-msg::before{
  content:'âœ“';position:absolute;right:18px;top:50%;
  transform:translateY(-50%);font-size:1.5rem;font-weight:800;
  color:#16a34a;
  animation:scaleIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes scaleIn{
  from{transform:translateY(-50%) scale(0) rotate(-180deg)}
  to{transform:translateY(-50%) scale(1) rotate(0)}
}

@keyframes slideIn{
  from{opacity:0;transform:translateX(30px)}
  to{opacity:1;transform:translateX(0)}
}

/* Skeleton */
.skeleton{
  background:linear-gradient(90deg,
    rgba(203,213,225,.2) 0%,
    rgba(203,213,225,.4) 50%,
    rgba(203,213,225,.2) 100%
  );
  background-size:200% 100%;
  animation:shimmer 1.5s ease-in-out infinite;
  border-radius:var(--radius-sm);
}

@keyframes shimmer{
  0%{background-position:200% 0}
  100%{background-position:-200% 0}
}

.blurred{
  filter:blur(8px) brightness(0.95);
  pointer-events:none;
  user-select:none;
  transition:filter 0.3s ease;
}

/* Modal */
.overlay{
  position:fixed;inset:0;z-index:1200;
  background:rgba(15,23,42,.4);
  backdrop-filter:blur(12px) saturate(150%);
  -webkit-backdrop-filter:blur(12px) saturate(150%);
  display:none;align-items:center;justify-content:center;padding:20px;
  animation:fadeIn 0.3s ease-out;
  overflow-y:auto;
  -webkit-overflow-scrolling:touch;
}

@keyframes fadeIn{
  from{opacity:0}
  to{opacity:1}
}

.overlay.active{display:flex}

.modal{
  width:100%;max-width:460px;
  background:linear-gradient(135deg,
    rgba(255,255,255,0.98) 0%,
    rgba(248,250,252,0.96) 100%
  );
  backdrop-filter:blur(30px) saturate(180%);
  -webkit-backdrop-filter:blur(30px) saturate(180%);
  border:1px solid rgba(226,232,240,0.8);
  border-radius:var(--radius-xl);
  padding:36px 28px;
  position:relative;
  box-shadow:
    0 25px 60px rgba(15,23,42,0.15),
    0 10px 25px rgba(15,23,42,0.08),
    inset 0 1px 0 rgba(255,255,255,1);
  animation:modalSlideUp 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.modal::before{
  content:'';
  position:absolute;
  top:-50%;
  right:-30%;
  width:200%;
  height:200%;
  background:radial-gradient(circle at 30% 30%, rgba(56,189,248,0.15) 0%, transparent 50%);
  animation:modalFloat 20s ease-in-out infinite;
  pointer-events:none;
}

.modal::after{
  content:'';
  position:absolute;
  bottom:-40%;
  left:-30%;
  width:180%;
  height:180%;
  background:radial-gradient(circle at 70% 70%, rgba(99,102,241,0.12) 0%, transparent 50%);
  animation:modalFloat 25s ease-in-out infinite reverse;
  pointer-events:none;
}

@keyframes modalFloat{
  0%, 100%{transform:translate(0, 0) scale(1)}
  33%{transform:translate(30px, -30px) scale(1.05)}
  66%{transform:translate(-20px, 20px) scale(0.98)}
}

@keyframes modalSlideUp{
  from{opacity:0;transform:translateY(40px) scale(0.95)}
  to{opacity:1;transform:translateY(0) scale(1)}
}

.modal h2{
  margin:0 0 8px;
  font-weight:800;
  font-size:1.6rem;
  letter-spacing:-0.02em;
  color:#0f172a;
  text-align:center;
  position:relative;
  z-index:1;
}

.modal-sub{
  margin:0 0 24px;
  color:#64748b;
  font-weight:600;
  font-size:1rem;
  text-align:center;
  position:relative;
  z-index:1;
  line-height:1.5;
}

.field{
  display:grid;
  gap:8px;
  margin-top:16px;
  position:relative;
  z-index:1;
}

.label{
  font-weight:700;
  font-size:0.95rem;
  color:#475569;
  text-align:right;
  margin-bottom:2px;
}

.ctrl{
  display:flex;
  align-items:center;
  gap:12px;
  border:2px solid rgba(203,213,225,0.5);
  border-radius:var(--radius-md);
  padding:14px 18px;
  background:rgba(255,255,255,0.98);
  backdrop-filter:blur(10px);
  transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow:0 2px 8px rgba(15,23,42,0.06);
  position:relative;
  overflow:visible;
}

.ctrl::before{
  content:'';
  position:absolute;
  inset:0;
  background:linear-gradient(135deg, rgba(14,165,233,0.05), rgba(99,102,241,0.05));
  opacity:0;
  transition:opacity 0.3s ease;
}

.ctrl:focus-within::before{
  opacity:1;
}

.ctrl:focus-within{
  border-color:#0ea5e9;
  box-shadow:
    0 0 0 3px rgba(14,165,233,0.12),
    0 4px 16px rgba(14,165,233,0.15),
    0 1px 3px rgba(15,23,42,0.1);
  background:rgba(255,255,255,1);
  transform:translateY(-2px);
}

.ctrl:hover:not(:focus-within){
  border-color:rgba(148,163,184,0.6);
  box-shadow:0 4px 12px rgba(15,23,42,0.08);
}

input[type="text"],input[type="password"]{
  width:100%;
  border:none;
  outline:none;
  background:transparent;
  font-size:1rem;
  color:#0f172a;
  text-align:right;
  font-weight:600;
  font-family:inherit;
  letter-spacing:-0.01em;
  -webkit-appearance:none;
  -moz-appearance:none;
  appearance:none;
  touch-action:manipulation;
  flex:1;
  min-width:0;
  z-index:1;
  position:relative;
}

input::placeholder{
  color:#94a3b8;
  opacity:0.7;
  font-weight:500;
}

.toggle-eye{
  cursor:pointer;
  color:var(--muted);
  font-size:.95rem;
  user-select:none;
  font-weight:800;
  transition:all 0.3s ease;
  padding:6px 10px;
  border-radius:var(--radius-sm);
  white-space:nowrap;
  flex-shrink:0;
  z-index:2;
  position:relative;
  pointer-events:auto;
}

.toggle-eye:hover{
  color:var(--primary);
  background:rgba(14,165,233,0.15);
  transform:scale(1.05);
}

.toggle-eye:active{
  transform:scale(0.98);
}

.form-actions{
  display:grid;
  gap:12px;
  margin-top:20px;
  position:relative;
  z-index:1;
}

.form-actions .btn{
  padding:14px 20px;
  font-size:1.05rem;
  font-weight:800;
  border-radius:var(--radius-md);
}

.form-actions .btn-primary{
  box-shadow:0 8px 25px rgba(14,165,233,0.3);
}

.form-actions .btn-ghost{
  background:rgba(255,255,255,0.6);
  border:2px solid rgba(148,163,184,0.3);
  color:#64748b;
  font-weight:700;
}

.form-actions .btn-ghost:hover{
  background:rgba(255,255,255,0.9);
  border-color:rgba(148,163,184,0.5);
  color:var(--text);
}

.msg-err{
  min-height:20px;
  color:#ef4444;
  font-weight:700;
  margin-top:10px;
  font-size:0.95rem;
  text-align:center;
  animation:shake 0.4s ease-out;
  position:relative;
  z-index:1;
}

.msg-ok{
  min-height:20px;
  color:#16a34a;
  font-weight:700;
  margin-top:10px;
  font-size:0.95rem;
  text-align:center;
  animation:slideIn 0.4s ease-out;
  position:relative;
  z-index:1;
}

/* Login Prompt Section */
.login-prompt{
  text-align:center;
  padding:40px 20px;
  margin-top:24px;
  background:linear-gradient(135deg, rgba(59,130,246,0.08) 0%, rgba(37,99,235,0.05) 100%);
  border-radius:var(--radius-lg);
  border:2px dashed rgba(59,130,246,0.3);
  position:relative;
  overflow:hidden;
}

.login-prompt::before{
  content:'';
  position:absolute;
  top:0;
  left:0;
  right:0;
  height:4px;
  background:linear-gradient(90deg, #3b82f6, #2563eb, #3b82f6);
  background-size:200% 100%;
  animation:shimmerFlow 2s linear infinite;
}

@keyframes shimmerFlow{
  0%{background-position:200% 0}
  100%{background-position:-200% 0}
}

.login-prompt-icon{
  font-size:3em;
  margin-bottom:16px;
  animation:floatUpDown 3s ease-in-out infinite;
}

@keyframes floatUpDown{
  0%,100%{transform:translateY(0)}
  50%{transform:translateY(-10px)}
}

.login-prompt h3{
  font-size:1.5em;
  font-weight:700;
  color:#1e293b;
  margin:0 0 12px 0;
}

.login-prompt p{
  color:#64748b;
  font-size:1.05em;
  margin:0 0 24px 0;
  line-height:1.6;
}

.login-prompt-btn{
  background:linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
  color:white;
  border:none;
  border-radius:16px;
  padding:16px 40px;
  font-size:1.2em;
  font-weight:700;
  cursor:pointer;
  box-shadow:0 8px 24px rgba(59,130,246,0.4);
  transition:all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  display:inline-flex;
  align-items:center;
  gap:12px;
}

.login-prompt-btn:hover{
  transform:translateY(-3px) scale(1.05);
  box-shadow:0 12px 32px rgba(59,130,246,0.5);
}

.login-prompt-btn:active{
  transform:translateY(-1px) scale(1.02);
}

.login-prompt-btn i{
  font-size:1.3em;
}

/* Helpers */
.hidden{display:none !important}

/* Responsive enhancements */
@media (max-width:640px){
  .container{padding:0 12px}
  .topbar{
    padding:14px 16px;
    margin-bottom:16px;
    flex-direction:column;
    gap:14px;
  }
  .topbar-actions{
    position:static;
    width:100%;
    justify-content:center;
    flex-wrap:wrap;
  }
  .topbar-actions .btn{
    flex:1;
    min-width:120px;
  }
  .brand{
    font-size:1.15rem;
    padding:6px 12px;
  }
  .brand-logo{
    width:44px !important;
    height:44px !important;
  }
  .hero-title{font-size:1.6rem}
  .hero-sub{font-size:0.95rem}
  .action{
    min-height:100px;
    padding:20px 16px;
  }
  .action-icon-wrapper{
    width:56px;
    height:56px;
  }
  .action-image{
    width:36px;
    height:36px;
  }
  .action-title{
    font-size:1.1rem;
  }
  .action-desc{
    font-size:0.85rem;
  }
  .action-arrow{
    width:28px;
    height:28px;
  }
  .action-arrow i{
    font-size:0.8rem;
  }
  .modal{
    padding:28px 20px;
    max-width:calc(100% - 24px);
    border-radius:var(--radius-lg);
  }
  .modal h2{font-size:1.4rem}
  .modal-sub{font-size:0.95rem}
  .ctrl{
    padding:16px 14px;
    min-height:56px;
  }
  input[type="text"],input[type="password"]{
    font-size:16px !important;
    min-height:24px;
  }
  .toggle-eye{
    font-size:0.9rem;
    padding:8px 12px;
    flex-shrink:0;
  }
  .form-actions .btn{
    padding:16px 20px;
    font-size:1.1rem;
    min-height:54px;
  }
  .hero{
    padding:24px 20px 20px;
  }
  .hero-greeting-icon{
    font-size:3em;
  }
  .hero-title{
    font-size:1.7rem;
  }
  .hero-sub{
    font-size:0.95rem;
  }
  .user-info-grid{
    gap:10px;
  }
  .info-card{
    padding:12px 14px;
  }
  .info-icon{
    width:40px;
    height:40px;
    font-size:1.1rem;
  }
  .info-label{
    font-size:0.75rem;
  }
  .info-value{
    font-size:0.95rem;
  }
  .overlay{
    padding:12px;
    align-items:flex-start;
    padding-top:60px;
  }
  .modal{
    margin:0 auto;
  }
}

@media (max-width:400px){
  .topbar{padding:12px 14px;gap:12px}
  .brand{font-size:1.05rem;gap:10px;padding:5px 10px}
  .brand-logo{width:40px !important;height:40px !important}
  .topbar-actions .btn{font-size:0.85rem;padding:8px 12px}
  .hero{
    padding:20px 16px 18px;
  }
  .hero-greeting-icon{
    font-size:2.8em;
  }
  .hero-title{
    font-size:1.5rem;
  }
  .hero-sub{
    font-size:0.9rem;
  }
  .user-info-grid{
    grid-template-columns:1fr;
    gap:8px;
  }
  .info-card{
    padding:12px 14px;
  }
  .info-icon{
    width:38px;
    height:38px;
    font-size:1rem;
  }
  .info-label{
    font-size:0.75rem;
  }
  .info-value{
    font-size:0.9rem;
  }
  .btn{padding:10px 14px;font-size:0.9rem}
  .action{
    min-height:90px;
    padding:16px 14px;
  }
  .action-icon-wrapper{
    width:52px;
    height:52px;
  }
  .action-image{
    width:32px;
    height:32px;
  }
  .action-title{
    font-size:1rem;
  }
  .action-desc{
    font-size:0.8rem;
  }
  .action-arrow{
    width:26px;
    height:26px;
  }
  .modal{
    padding:24px 18px;
    max-width:calc(100% - 20px);
  }
  .modal h2{font-size:1.3rem}
  .modal-sub{font-size:0.9rem;margin-bottom:20px}
  .field{margin-top:14px}
  .label{font-size:0.9rem}
  .ctrl{
    padding:14px 12px;
    min-height:54px;
  }
  input[type="text"],input[type="password"]{
    font-size:16px !important;
    min-height:22px;
  }
  .toggle-eye{
    font-size:0.85rem;
    padding:6px 10px;
  }
  .form-actions{margin-top:18px}
  .form-actions .btn{
    padding:14px 18px;
    font-size:1.05rem;
    min-height:52px;
  }
  .pill{padding:8px 14px;font-size:0.85rem}
  .pill span{font-size:0.8rem}
  .pill strong{font-size:0.9rem}
  .overlay{
    padding:8px;
    align-items:flex-start;
    padding-top:40px;
  }
  .modal{
    margin:0 auto;
  }
}

/* Smooth scrolling */
html{scroll-behavior:smooth}

/* Custom scrollbar */
::-webkit-scrollbar{width:10px;height:10px}
::-webkit-scrollbar-track{background:rgba(148,163,184,0.1);border-radius:10px}
::-webkit-scrollbar-thumb{
  background:#94a3b8;
  border-radius:10px;
}
::-webkit-scrollbar-thumb:hover{background:#64748b}

/* Advanced micro-interactions */
@keyframes ripple{
  to{
    transform:scale(4);
    opacity:0;
  }
}

.btn,.action,.pill,.toggle-eye{
  position:relative;
  overflow:hidden;
}

.btn::after,.action::after{
  content:'';
  position:absolute;
  width:100px;
  height:100px;
  background:rgba(255,255,255,0.5);
  border-radius:50%;
  transform:scale(0);
  pointer-events:none;
}

.btn:active::after,.action:active::after{
  animation:ripple 0.6s ease-out;
}

/* Focus visible for accessibility */
:focus-visible{
  outline:3px solid rgba(14,165,233,0.5);
  outline-offset:3px;
}

/* Subtle page load animation */
@keyframes pageLoad{
  from{
    opacity:0;
    transform:translateY(20px);
  }
  to{
    opacity:1;
    transform:translateY(0);
  }
}

body{
  animation:pageLoad 0.5s ease-out;
}

/* Enhanced button states with scale */
.btn,.action{
  will-change:transform;
}

/* Magnetic hover effect for icons */
.brand-logo,.action i{
  transition:transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.brand:hover .brand-logo{
  animation:magneticPulse 0.8s ease-in-out infinite;
}

@keyframes magneticPulse{
  0%,100%{transform:rotate(8deg) scale(1.12)}
  50%{transform:rotate(8deg) scale(1.18)}
}

/* Enhanced pill interaction */
.pill{
  will-change:transform,box-shadow;
}

/* Smooth color transitions */
*{
  transition-property:background-color,border-color,color,fill,stroke;
  transition-duration:0.2s;
  transition-timing-function:ease;
}

/* Enhanced focus states */
input:focus,button:focus{
  outline:none;
}

/* Glow effect on active elements */
.btn-primary:focus-visible{
  box-shadow:
    0 0 0 3px rgba(14,165,233,0.2),
    0 8px 25px rgba(14,165,233,0.4);
}

/* Loading state shimmer */
@keyframes loadingShimmer{
  0%{background-position:-200% 0}
  100%{background-position:200% 0}
}

.skeleton{
  background:linear-gradient(90deg,
    rgba(203,213,225,.2) 0%,
    rgba(203,213,225,.5) 50%,
    rgba(203,213,225,.2) 100%
  );
  background-size:200% 100%;
  animation:loadingShimmer 1.5s ease-in-out infinite;
}
</style>

</head>

<body>

<div class="container">

<div class="topbar">

<div class="brand">

<img src="/assets/mobile_pos/icons/web-app-manifest-192x192.png" alt="Elnoor-Ø§Ù„Ù†ÙˆØ±" class="brand-logo" style="width:48px;height:48px;border-radius:14px;box-shadow:0 8px 24px rgba(14, 165, 233, .2)" />

<div>Elnoor-Ø§Ù„Ù†ÙˆØ±</div>

</div>

<div class="topbar-actions">

<button id="install-app" class="btn btn-success hidden" type="button">ğŸ“± ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</button>

<button id="login-open" class="btn btn-primary hidden" type="button">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>

</div>

</div>

<div id="main-card" class="card">
  <div class="hero">
    <div class="hero-header">
      <div class="hero-greeting-icon">ğŸ‘‹</div>
      <div class="hero-content">
        <h1 id="hero-title" class="hero-title">Ù…Ø±Ø­Ø¨Ù‹Ø§</h1>
        <p id="hero-sub" class="hero-sub">ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø±ÙŠØ«Ù…Ø§ Ù†Ù‚ÙˆÙ… Ø¨ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ...</p>
      </div>
    </div>

    <div class="user-info-grid">
      <div class="info-card">
        <div class="info-icon user-icon">
          <i class="fa fa-user"></i>
        </div>
        <div class="info-details">
          <span class="info-label">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</span>
          <strong id="user-name" class="info-value skeleton"></strong>
        </div>
      </div>
      <div class="info-card">
        <div class="info-icon warehouse-icon">
          <i class="fa fa-cubes"></i>
        </div>
        <div class="info-details">
          <span class="info-label">Ø§Ù„Ù…Ø®Ø²Ù†/Ø§Ù„Ø³ÙŠØ§Ø±Ø©</span>
          <strong id="warehouse" class="info-value skeleton"></strong>
        </div>
      </div>
    </div>
  </div>

  <div id="actions" class="actions-grid">
    <a id="link-pos" class="action act-pos" href="/app/mini-pos">
      <div class="action-content">
        <div class="action-icon-wrapper">
          <img src="/assets/mobile_pos/pos-icon.jpg" alt="POS" class="action-image">
        </div>
        <div class="action-text">
          <h3 class="action-title">Ù†Ù‚Ø·Ø© Ø§Ù„Ø¨ÙŠØ¹</h3>
          <p class="action-desc">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª ÙˆØ§Ù„ÙÙˆØ§ØªÙŠØ±</p>
        </div>
      </div>
      <div class="action-arrow">
        <i class="fa fa-chevron-left"></i>
      </div>
    </a>
    <a id="link-truck" class="action act-truck" href="/app/stock-trans">
      <div class="action-content">
        <div class="action-icon-wrapper">
          <img src="/assets/mobile_pos/car.png" alt="Stock" class="action-image">
        </div>
        <div class="action-text">
          <h3 class="action-title">ØªØ­Ù…ÙŠÙ„ ÙˆØªÙØ±ÙŠØº Ø§Ù„Ø³ÙŠØ§Ø±Ø©</h3>
          <p class="action-desc">Ø¥Ø¯Ø§Ø±Ø© Ø­Ø±ÙƒØ§Øª Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</p>
        </div>
      </div>
      <div class="action-arrow">
        <i class="fa fa-chevron-left"></i>
      </div>
    </a>
    <a id="link-admin" class="action act-admin hidden" href="/app/admin">
      <div class="action-content">
        <div class="action-icon-wrapper">
          <i class="fa fa-dashboard" style="font-size:28px;color:white;"></i>
        </div>
        <div class="action-text">
          <h3 class="action-title">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h3>
          <p class="action-desc">Ø¥Ø¯Ø§Ø±Ø© ÙˆÙ…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù†Ø¸Ø§Ù…</p>
        </div>
      </div>
      <div class="action-arrow">
        <i class="fa fa-chevron-left"></i>
      </div>
    </a>
  </div>

  <div id="login-prompt-section" class="login-prompt hidden">
    <div class="login-prompt-icon">ğŸ”</div>
    <h3>ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬Ùƒ</h3>
    <p>ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø© ÙˆØ§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙŠØ²Ø§Øª</p>
    <button id="prompt-login-btn" class="login-prompt-btn">
      <i class="fa fa-sign-in"></i>
      <span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</span>
    </button>
  </div>

  <div id="contact-admin-section" class="login-prompt hidden">
    <div class="login-prompt-icon">âš ï¸</div>
    <h3>ØºÙŠØ± Ù…ØµØ±Ø­ Ù„Ùƒ Ø¨Ø§Ù„ÙˆØµÙˆÙ„</h3>
    <p>ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ù„ÙØªØ­ ØµÙ„Ø§Ø­ÙŠØ§Øª Ù„Ùƒ</p>
  </div>

  <div id="install-success" class="success-msg hidden"></div>
  <div id="notice" class="notice hidden"></div>
  <div id="error" class="error hidden"></div>

  <a id="main-system-btn" href="/app/home" class="btn btn-primary hidden" style="width:100%;margin-top:32px;padding:18px;font-size:1.15rem;font-weight:800;display:flex;align-items:center;justify-content:center;gap:12px;border-radius:var(--radius-lg);box-shadow:0 8px 25px rgba(59,130,246,0.35);text-decoration:none;">
    <i class="fa fa-desktop" style="font-size:1.2em;"></i>
    <span>Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</span>
  </a>

  <button id="logout" class="btn btn-danger" type="button" style="width:100%;margin-top:16px;padding:18px;font-size:1.15rem;font-weight:800;display:flex;align-items:center;justify-content:center;gap:12px;border-radius:var(--radius-lg);box-shadow:0 8px 25px rgba(239,68,68,0.35);">
    <i class="fa fa-sign-out" style="font-size:1.2em;"></i>
    <span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span>
  </button>
</div>
</div>

<!-- Login Modal -->

<div id="overlay" class="overlay" role="dialog" aria-modal="true" aria-labelledby="login-title">

<div class="modal">

<h2 id="login-title">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„ÙˆØµÙˆÙ„</h2>

<p class="modal-sub">Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</p>

<form id="login-form" class="form" autocomplete="on">

<div class="field">

<label class="label" for="usr">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>

<div class="ctrl">

<input id="usr" name="usr" type="text" autocomplete="username" required placeholder="example@site.com Ø£Ùˆ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" />

</div>

</div>

<div class="field">

<label class="label" for="pwd">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>

<div class="ctrl">

<input id="pwd" name="pwd" type="password" autocomplete="current-password" required placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" />

<span id="eye" class="toggle-eye">Ø¥Ø¸Ù‡Ø§Ø±</span>

</div>

</div>

<div id="login-err" class="msg-err" aria-live="assertive"></div>

<div id="login-ok" class="msg-ok" aria-live="polite"></div>

<div class="form-actions">

<button id="submit" class="btn btn-primary" type="submit">Ø¯Ø®ÙˆÙ„</button>

<button id="cancel" class="btn btn-ghost" type="button">Ø¥Ù„ØºØ§Ø¡</button>

</div>

</form>

</div>

</div>

<script>

const USE_FRAPPE = true;

const STORAGE_KEY = "mini_pos_last_username";

const FORCE_GUEST_KEY = "mini_pos_force_guest";

const $ = (id)=>document.getElementById(id);

const mainCard=$("main-card");

const heroTitle=$("hero-title");

const heroSub=$("hero-sub");

const userName=$("user-name");

const warehouse=$("warehouse");

const actions=$("actions");

const notice=$("notice");

const errorBox=$("error");

const installSuccess=$("install-success");

const logoutBtn=$("logout");

const loginOpenBtn=$("login-open");

const installAppBtn=$("install-app");

const overlay=$("overlay");

const loginForm=$("login-form");

const usr=$("usr");

const pwd=$("pwd");

const eye=$("eye");

const submitBtn=$("submit");

const cancelBtn=$("cancel");

const loginErr=$("login-err");

const loginOk=$("login-ok");

const loginPromptSection=$("login-prompt-section");

const promptLoginBtn=$("prompt-login-btn");

const contactAdminSection=$("contact-admin-section");

const mainSystemBtn=$("main-system-btn");

const linkAdmin=$("link-admin");

// PWA Install functionality
let deferredPrompt;

function hide(el){el.classList.add("hidden")}

function show(el){el.classList.remove("hidden")}

function setSkeleton(on){

[userName,warehouse].forEach(el=>{

el.classList.toggle("skeleton",on);

if(on) el.textContent="";

});

}

function showNotice(text){

if(!text){hide(notice);notice.textContent="";return}

notice.textContent=text;show(notice);

}

function showError(text){

if(!text){hide(errorBox);errorBox.textContent="";return}

errorBox.textContent=text;show(errorBox);

}

function showInstallSuccess(text){

if(!text){hide(installSuccess);installSuccess.textContent="";return}

installSuccess.textContent=text;show(installSuccess);

setTimeout(()=>hide(installSuccess),5000);

}

function disableActions(disabled){actions.classList.toggle("disabled",!!disabled)}

function setForceGuest(on){try{on?sessionStorage.setItem(FORCE_GUEST_KEY,"1"):sessionStorage.removeItem(FORCE_GUEST_KEY)}catch(_){}}

function isForceGuest(){try{return sessionStorage.getItem(FORCE_GUEST_KEY)==="1"}catch(_){return false}}

async function apiLogin(username,password){

if(!USE_FRAPPE){

await new Promise(r=>setTimeout(r,350));

if(!username||!password)throw new Error("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ­ÙŠØ­Ø©");

return true;

}

const res=await fetch("/api/method/login",{

method:"POST",

headers:{"Content-Type":"application/json","Accept":"application/json"},

credentials:"same-origin",

cache:"no-store",

body:JSON.stringify({usr:username,pwd:password})

});

if(!res.ok)throw new Error("ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…");

const data=await res.json();

const msg=data&&(data.message||data.msg||data.status);

if(msg!=="Logged In"&&msg?.message!=="Logged In")throw new Error("Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©");

return true;

}

async function apiLogout(){

if(!USE_FRAPPE){
await new Promise(r=>setTimeout(r,350));
return true;
}

try{

const res=await fetch("/api/method/logout",{
method:"POST",
credentials:"same-origin",
cache:"no-store",
headers:{
"Accept":"application/json",
"Content-Type":"application/json"
}
});

if(res.ok){
const data=await res.json();
console.log("Logout response:",data);
}

}catch(err){
console.error("Logout error:",err);
}

// Clear all cookies
try{

document.cookie.split(";").forEach(c=>{

const [name]=c.split("=");

if(name){
const cookieName=name.trim();
// Clear cookie for root path
document.cookie=cookieName+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;";
// Clear cookie for current path
document.cookie=cookieName+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path="+window.location.pathname+";";
}

});

}catch(err){
console.error("Cookie clear error:",err);
}

// Small delay to ensure cookies are cleared
await new Promise(r=>setTimeout(r,200));

}

async function fetchContext(){

if(isForceGuest())return{user_id:"Guest",profile_allowed:0};

try{

const r=await fetch("/api/method/mobile_pos.mobile_pos.page.main.api.get_home_context",{

credentials:"same-origin",cache:"no-store",headers:{"Accept":"application/json","Cache-Control":"no-cache"}

});

if(r.ok){const j=await r.json();return j.message||j;}

}catch(_){}

try{

const r=await fetch("/api/method/frappe.auth.get_logged_user",{

credentials:"same-origin",cache:"no-store",headers:{"Accept":"application/json","Cache-Control":"no-cache"}

});

if(!r.ok)return{user_id:"Guest",profile_allowed:0};

const j=await r.json();const user=j.message||j;

if(!user||user==="Guest")return{user_id:"Guest",profile_allowed:0};

return {user_id:user,user_full_name:user,warehouse:null,profile_allowed:1,profile_disabled:0};

}catch(_){return{user_id:"Guest",profile_allowed:0};}

}

function openLogin(preset=""){

try{usr.value=localStorage.getItem(STORAGE_KEY)||preset||""}catch(_){usr.value=preset||""}

pwd.value="";loginErr.textContent="";loginOk.textContent="";

overlay.classList.add("active");mainCard.classList.add("blurred");

setTimeout(()=>usr.focus(),80);

}

function closeLogin(){overlay.classList.remove("active");mainCard.classList.remove("blurred")}

function renderAllowed(ctx){

const name=ctx.user_full_name||ctx.user_id||"-";

[userName,warehouse].forEach(el=>el.classList.remove("skeleton"));

heroTitle.textContent="Ù…Ø±Ø­Ø¨Ù‹Ø§ " + name;

heroSub.textContent="ÙƒÙ„ Ø´ÙŠØ¡ Ø¬Ø§Ù‡Ø². ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø¢Ù†.";

userName.textContent=name;

warehouse.textContent=ctx.warehouse||"-";

// Check if user is System User based on pos_user_type field
const posUserType = ctx.pos_user_type || "System User";
const isSystemUser = posUserType === "System User";
const isAdmin = posUserType === "Admin" || ctx.is_admin;
const isWebsiteUser = posUserType === "Website User";
const hasProfile = parseInt(ctx.profile_allowed || 0) === 1;

console.log("POS User Type:", posUserType);
console.log("Is System User:", isSystemUser);
console.log("Is Admin:", isAdmin);
console.log("Is Website User:", isWebsiteUser);
console.log("Has Profile:", hasProfile);
console.log("Profile allowed:", ctx.profile_allowed);

// Get action links
const linkPos = $("link-pos");
const linkTruck = $("link-truck");

// ========== ADMIN USER ==========
// Admin sees ONLY the Admin Dashboard button, nothing else
if (isAdmin) {
  console.log("Admin User - showing ONLY Admin Dashboard link");

  // Show admin link
  linkAdmin.classList.remove("hidden");

  // Hide all other actions (POS, Stock)
  if (linkPos) linkPos.classList.add("hidden");
  if (linkTruck) linkTruck.classList.add("hidden");

  // Hide main system button for admin
  mainSystemBtn.classList.add("hidden");

  // Show actions container but hide individual action cards
  actions.classList.remove("hidden");
  actions.classList.remove("blurred");
  disableActions(false);

  hide(loginPromptSection);
  hide(contactAdminSection);

// ========== SYSTEM USER ==========
} else if (isSystemUser) {
  console.log("System User - showing System button");

  // Hide admin link
  linkAdmin.classList.add("hidden");

  // Show main system button
  mainSystemBtn.classList.remove("hidden");

  // Show POS and Stock if has profile
  if (hasProfile) {
    console.log("System User with profile - showing POS and Stock");
    if (linkPos) linkPos.classList.remove("hidden");
    if (linkTruck) linkTruck.classList.remove("hidden");
    actions.classList.remove("hidden");
    actions.classList.remove("blurred");
    disableActions(false);
  } else {
    console.log("System User without profile - blurring POS and Stock");
    if (linkPos) linkPos.classList.remove("hidden");
    if (linkTruck) linkTruck.classList.remove("hidden");
    actions.classList.remove("hidden");
    actions.classList.add("blurred");
    disableActions(true);
  }

  hide(loginPromptSection);
  hide(contactAdminSection);

// ========== WEBSITE USER ==========
} else if (isWebsiteUser) {
  console.log("Website User");

  // Hide admin link and system button
  linkAdmin.classList.add("hidden");
  mainSystemBtn.classList.add("hidden");

  if (hasProfile) {
    console.log("Website User with profile - showing POS and Stock");
    if (linkPos) linkPos.classList.remove("hidden");
    if (linkTruck) linkTruck.classList.remove("hidden");
    actions.classList.remove("hidden");
    actions.classList.remove("blurred");
    disableActions(false);
    hide(loginPromptSection);
    hide(contactAdminSection);
  } else {
    console.log("Website User without profile - show contact admin message");
    actions.classList.add("hidden");
    show(contactAdminSection);
    hide(loginPromptSection);
  }

// ========== DEFAULT/UNKNOWN ==========
} else {
  console.log("Unknown user type - treating as Website User without profile");
  linkAdmin.classList.add("hidden");
  mainSystemBtn.classList.add("hidden");
  actions.classList.add("hidden");
  show(contactAdminSection);
  hide(loginPromptSection);
}

logoutBtn.classList.remove("hidden");

loginOpenBtn.classList.add("hidden");

}

function renderBlocked(ctx){

const name=ctx.user_full_name||ctx.user_id||"-";

heroTitle.textContent="Ù…Ø±Ø­Ø¨Ù‹Ø§ " + name;

heroSub.textContent="Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ø¸Ø§Ù… Ø­ØªÙ‰ ÙŠÙØ¹Ù‘Ù„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ù…Ù„ÙÙƒ.";

userName.textContent=name;warehouse.textContent="-";

showNotice("ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­ Ù„Ùƒ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ø¸Ø§Ù…. ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„.");

actions.classList.add("hidden");

hide(contactAdminSection);

hide(loginPromptSection);

mainSystemBtn.classList.add("hidden");

logoutBtn.classList.remove("hidden");

loginOpenBtn.classList.add("hidden");

}

async function loadMain(){

setSkeleton(true);showNotice("");showError("");

console.log("=== loadMain() started ===");

try{

const ctx=await fetchContext();
console.log("Context received:", ctx);

if(!ctx||!ctx.user_id||ctx.user_id==="Guest"){

heroTitle.textContent="Ù…Ø±Ø­Ø¨Ù‹Ø§";

heroSub.textContent="ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬Ùƒ. ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©.";

[userName,warehouse].forEach(el=>el.classList.remove("skeleton"));

userName.textContent="-";warehouse.textContent="-";

actions.classList.add("hidden");

show(loginPromptSection);

hide(contactAdminSection);

loginOpenBtn.classList.add("hidden");

mainSystemBtn.classList.add("hidden");

logoutBtn.classList.add("hidden");

return;

}

// Always call renderAllowed to handle all scenarios based on pos_user_type and profile status
renderAllowed(ctx);

}catch(e){

showError("ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: "+(e?.message||"Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"));

}finally{setSkeleton(false)}

}

// PWA Install Event Handlers
window.addEventListener('beforeinstallprompt', (e) => {

e.preventDefault();

deferredPrompt = e;

show(installAppBtn);

console.log('ğŸ“± Install prompt available');

});

installAppBtn.addEventListener('click', async () => {

if (!deferredPrompt) {

showNotice("Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù…Ø«Ø¨Øª Ø¨Ø§Ù„ÙØ¹Ù„ Ø£Ùˆ ØºÙŠØ± Ù…ØªØ§Ø­ Ù„Ù„ØªØ«Ø¨ÙŠØª Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø²");

return;

}

deferredPrompt.prompt();

const { outcome } = await deferredPrompt.userChoice;

if (outcome === 'accepted') {

showInstallSuccess("âœ… ØªÙ… ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„ÙŠÙ‡ Ù…Ù† Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©");

hide(installAppBtn);

} else {

showNotice("ØªÙ… Ø¥Ù„ØºØ§Ø¡ ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚");

}

deferredPrompt = null;

});

window.addEventListener('appinstalled', () => {

hide(installAppBtn);

showInstallSuccess("âœ… ØªÙ… ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ù†Ø¬Ø§Ø­ Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²Ùƒ!");

deferredPrompt = null;

console.log('âœ… PWA installed successfully');

});

loginForm.addEventListener("submit",async e=>{

e.preventDefault();loginErr.textContent="";loginOk.textContent="";

submitBtn.disabled=true;

try{

await apiLogin(usr.value,pwd.value);setForceGuest(false);

loginOk.textContent="ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­";

try{localStorage.setItem(STORAGE_KEY,usr.value.trim())}catch(_){}

setTimeout(async()=>{closeLogin();await loadMain();},250);

}catch(err){loginErr.textContent=err?.message||"Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„"}

finally{submitBtn.disabled=false}

});

eye.addEventListener("click",()=>{const isPwd=pwd.type==="password";pwd.type=isPwd?"text":"password";eye.textContent=isPwd?"Ø¥Ø®ÙØ§Ø¡":"Ø¥Ø¸Ù‡Ø§Ø±";pwd.focus()});

cancelBtn.addEventListener("click",()=>closeLogin());

overlay.addEventListener("click",(e)=>{if(e.target===overlay)closeLogin()});

document.addEventListener("keydown",(e)=>{if(e.key==="Escape"&&overlay.classList.contains("active"))closeLogin()});

loginOpenBtn.addEventListener("click",()=>openLogin(localStorage.getItem(STORAGE_KEY)||""));

promptLoginBtn.addEventListener("click",()=>openLogin(localStorage.getItem(STORAGE_KEY)||""));

logoutBtn.addEventListener("click",async()=>{

logoutBtn.disabled=true;

heroSub.textContent="Ø¬Ø§Ø±Ù ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬...";

try{

await apiLogout();

setForceGuest(true);

// Reload the page to ensure clean logout
setTimeout(()=>{
window.location.reload();
},500);

}catch(err){

console.error("Logout failed:",err);

heroSub.textContent="ÙØ´Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.";

logoutBtn.disabled=false;

}

});

// Initialize: Hide main system button by default
mainSystemBtn.classList.add("hidden");

window.addEventListener("load",loadMain);

if ("serviceWorker" in navigator) {

window.addEventListener("load", () => {

navigator.serviceWorker

.register("/main/sw.js")

.then(() => console.log("âœ… Elnoor-Ø§Ù„Ù†ÙˆØ± PWA registered"))

.catch((err) => console.error("SW registration failed:", err));

});

}

// === EXPERT-LEVEL ENHANCEMENTS ===

// Ripple effect on button clicks
document.addEventListener('click', function(e) {
  const btn = e.target.closest('.btn, .action, .pill');
  if (!btn) return;

  const ripple = document.createElement('span');
  const rect = btn.getBoundingClientRect();
  const size = Math.max(rect.width, rect.height);
  const x = e.clientX - rect.left - size / 2;
  const y = e.clientY - rect.top - size / 2;

  ripple.style.cssText = `
    position: absolute;
    width: ${size}px;
    height: ${size}px;
    left: ${x}px;
    top: ${y}px;
    background: rgba(255,255,255,0.6);
    border-radius: 50%;
    transform: scale(0);
    animation: ripple 0.6s ease-out;
    pointer-events: none;
  `;

  btn.appendChild(ripple);
  setTimeout(() => ripple.remove(), 600);
});

// Parallax effect on hero section
let ticking = false;
let lastScrollY = 0;

window.addEventListener('scroll', function() {
  lastScrollY = window.scrollY;
  if (!ticking) {
    window.requestAnimationFrame(function() {
      const hero = document.querySelector('.hero');
      if (hero && lastScrollY < 500) {
        const offset = lastScrollY * 0.5;
        hero.style.transform = `translateY(${offset}px)`;
        hero.style.opacity = Math.max(0.3, 1 - lastScrollY / 500);
      }
      ticking = false;
    });
    ticking = true;
  }
});

// Enhanced input focus with subtle animation
const inputs = document.querySelectorAll('input[type="text"], input[type="password"]');
inputs.forEach(input => {
  input.addEventListener('focus', function() {
    this.parentElement.style.transform = 'translateY(-2px)';
  });
  input.addEventListener('blur', function() {
    if (!this.value) {
      this.parentElement.style.transform = 'translateY(0)';
    }
  });
});

// Smooth scroll to top on page load
if (window.scrollY > 0) {
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// Add loading state to all buttons
document.addEventListener('click', function(e) {
  const btn = e.target.closest('button[type="submit"]');
  if (btn && !btn.disabled) {
    const originalText = btn.innerHTML;
    btn.dataset.originalText = originalText;
  }
});

// Preload hover states for better performance
const hoverElements = document.querySelectorAll('.btn, .action, .pill, .toggle-eye');
hoverElements.forEach(el => {
  el.addEventListener('mouseenter', function() {
    this.style.willChange = 'transform, box-shadow';
  });
  el.addEventListener('mouseleave', function() {
    this.style.willChange = 'auto';
  });
});

// Enhanced keyboard navigation
document.addEventListener('keydown', function(e) {
  // Tab navigation enhancement
  if (e.key === 'Tab') {
    document.body.classList.add('keyboard-navigation');
  }
  // Escape key to close modal
  if (e.key === 'Escape') {
    const activeModal = document.querySelector('.overlay.active');
    if (activeModal) {
      const cancelBtn = document.querySelector('#cancel');
      if (cancelBtn) cancelBtn.click();
    }
  }
});

document.addEventListener('mousedown', function() {
  document.body.classList.remove('keyboard-navigation');
});

// Performance monitoring
if (window.performance && window.performance.mark) {
  window.addEventListener('load', function() {
    performance.mark('page-loaded');
    const perfData = performance.getEntriesByType('navigation')[0];
    if (perfData) {
      console.log('ğŸ“Š Page Load Time:', Math.round(perfData.loadEventEnd), 'ms');
    }
  });
}

console.log('âœ¨ Advanced enhancements loaded successfully');

</script>

</body>

</html>